use role accountadmin;

set the_user='pbm_databricks_user_API'
SET the_role='pbm_developer';
set the_warehouse='PBM_WH';
set the_database='pbm_db'
set the_schema='PBM_SCHEMA'


/*SHOW VARIABLES;*/


create role if not exists  IDENTIFIER($the_role);

grant usage on warehouse IDENTIFIER($the_warehouse) to role IDENTIFIER($the_role);


grant usage on database IDENTIFIER($the_database) to role IDENTIFIER($the_role);
grant usage on schema IDENTIFIER($the_database).IDENTIFIER($the_schema) to role IDENTIFIER($the_role);

grant select on all tables in schema IDENTIFIER($the_database).IDENTIFIER($the_schema)  to role IDENTIFIER($the_role);


grant role IDENTIFIER($the_role) to user IDENTIFIER($the_user);
show grants to role IDENTIFIER($the_role);
